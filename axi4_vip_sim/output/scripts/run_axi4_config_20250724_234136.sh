#!/bin/bash
#==============================================================================
# AXI4 VIP Test Script - Generated 20250724_234136
# Auto-generated by AXI4 Bus Matrix Configuration GUI
#==============================================================================

set -e  # Exit on error

# Configuration
UVM_SIM_PATH="../axi4_vip_sim"
CONFIG_NAME="axi4_config_20250724_234136"
CONFIG_JSON="$UVM_SIM_PATH/output/configs/$CONFIG_NAME.json"

# Colors for output
RED="\033[0;31m"
GREEN="\033[0;32m"
YELLOW="\033[1;33m"
BLUE="\033[0;34m"
NC="\033[0m" # No Color

print_msg() {
    echo -e "${1}[GUI_TEST] ${2}${NC}"
}

print_msg $BLUE "Starting AXI4 VIP test with GUI configuration"
print_msg $BLUE "Bus Type: AXI4"
print_msg $BLUE "Masters: 2, Slaves: 3"
print_msg $BLUE "Data Width: 64 bits"

# Change to UVM simulation directory
cd "$UVM_SIM_PATH" || {
    print_msg $RED "Failed to change to UVM simulation directory"
    exit 1
}

# Create output directories
mkdir -p output/configs
mkdir -p output/logs
mkdir -p output/reports

print_msg $YELLOW "Running AXI4 VIP simulation..."

# Run basic test
print_msg $BLUE "Phase 1: Basic Test"
make run TEST=axi4_basic_test CONFIG_FILE="$CONFIG_JSON" || {
    print_msg $RED "Basic test failed"
    exit 1
}

# Run comprehensive test if basic passes
print_msg $BLUE "Phase 2: Comprehensive Test"
make run TEST=axi4_comprehensive_test CONFIG_FILE="$CONFIG_JSON" || {
    print_msg $RED "Comprehensive test failed"
    exit 1
}

# Generate reports
print_msg $BLUE "Generating reports..."
make coverage 2>/dev/null || true

print_msg $GREEN "[OK] AXI4 VIP tests completed successfully!"
print_msg $BLUE "Check results in: $UVM_SIM_PATH/output/"
