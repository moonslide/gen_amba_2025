//==============================================================================
// HDL Top Module
// Generated by AMBA Bus Matrix Configuration Tool
// Date: 2025-07-29 09:33:31
//==============================================================================

module hdl_top;
    
    import axi4_globals_pkg::*;
    import uvm_pkg::*;
    
    // Clock and reset
    logic aclk;
    logic aresetn;
    
    // Clock generation
    initial begin
        aclk = 0;
        forever #5ns aclk = ~aclk;
    end
    
    // Reset generation
    initial begin
        aresetn = 0;
        repeat(10) @(posedge aclk);
        aresetn = 1;
    end
    
    // AXI4 interfaces
    axi4_if axi_if[NO_OF_MASTERS](aclk, aresetn);
    
    // Master agent BFMs
    axi4_master_agent_bfm master_bfm[NO_OF_MASTERS](aclk, aresetn);
    
    // Slave agent BFMs
    axi4_slave_agent_bfm slave_bfm[NO_OF_SLAVES](aclk, aresetn);
    
    // FSDB dumping
    `ifdef DUMP_FSDB
    initial begin
        $display("[%0t] Starting FSDB dump", $time);
        $fsdbDumpfile("axi4_vip.fsdb");
        $fsdbDumpvars(0, hdl_top);
        $fsdbDumpvars("+struct");
        $fsdbDumpvars("+mda");
        $fsdbDumpvars("+all");
        $fsdbDumpon();
    end
    `endif
    
    // VCD dumping (alternative)
    `ifdef DUMP_VCD
    initial begin
        $display("[%0t] Starting VCD dump", $time);
        $dumpfile("axi4_vip.vcd");
        $dumpvars(0, hdl_top);
        $dumpon();
    end
    `endif
    
    // Waveform control tasks
    task enable_wave_dump();
        `ifdef DUMP_FSDB
            $fsdbDumpon();
            $display("[%0t] FSDB dumping enabled", $time);
        `elsif DUMP_VCD
            $dumpon();
            $display("[%0t] VCD dumping enabled", $time);
        `else
            $display("[%0t] No waveform dumping configured. Use +define+DUMP_FSDB or +define+DUMP_VCD", $time);
        `endif
    endtask
    
    task disable_wave_dump();
        `ifdef DUMP_FSDB
            $fsdbDumpoff();
            $display("[%0t] FSDB dumping disabled", $time);
        `elsif DUMP_VCD
            $dumpoff();
            $display("[%0t] VCD dumping disabled", $time);
        `endif
    endtask
    
    // Dump control from plusargs
    initial begin
        string dump_file;
        if ($value$plusargs("fsdb_file=%s", dump_file)) begin
            `ifdef DUMP_FSDB
                $fsdbDumpfile(dump_file);
                $display("[%0t] FSDB file set to: %s", $time, dump_file);
            `endif
        end
    end
    
    // RTL DUT instance
    dut_wrapper #(
        .ADDR_WIDTH(ADDRESS_WIDTH),
        .DATA_WIDTH(DATA_WIDTH),
        .ID_WIDTH(ID_WIDTH)
    ) dut (
        .clk(aclk),
        .rst_n(aresetn),
        .axi_if(axi_if)  // Connect entire interface array
    );
    
endmodule : hdl_top
